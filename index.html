<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Créateur de Site PRO</title>
<style id="main-styles">
    :root {
        --color-accent: #007bff; --color-heading: #212529; --color-text: #343a40; --color-bg: #ffffff; --color-surface: #f8f9fa;
        --border-color: #dee2e6; --font-main: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        --shadow-sm: 0 2px 10px rgba(0,0,0,0.07); --shadow-md: 0 5px 20px rgba(0,0,0,0.1);
    }
    html.dark-theme {
        --color-accent: #4dabf7; --color-heading: #ffffff; --color-text: #ced4da; --color-bg: #121212; --color-surface: #1e2022;
        --border-color: #495057;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: var(--font-main); background-color: #eef1f3; color: #333; line-height: 1.6; }
    .container { display: flex; height: 100vh; }
    .customizer { width: 420px; background: #fff; padding: 25px; box-shadow: var(--shadow-md); overflow-y: auto; display: flex; flex-direction: column; z-index: 10; }
    .customizer h2 { margin-bottom: 20px; border-bottom: 2px solid var(--color-accent); padding-bottom: 10px; color: #2c3e50; font-size: 1.5rem; display: flex; align-items: center; gap: 10px; }
    .form-group { margin-bottom: 18px; }
    .form-group label { display: block; margin-bottom: 6px; font-weight: 600; color: #34495e; font-size: 0.9rem; }
    .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-family: inherit; transition: border-color 0.3s; background: #fdfdfd; font-size: 1rem; }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus { border-color: var(--color-accent); outline: none; box-shadow: 0 0 5px rgba(0, 123, 255, 0.25); }
    .form-group textarea { min-height: 100px; resize: vertical; }
    .form-group.color-input { display: flex; align-items: center; justify-content: space-between; }
    .form-group.color-input input[type="color"] { width: 50px; height: 35px; padding: 2px; border: none; background: none; cursor: pointer; }
    .form-group.color-input .color-value { font-family: monospace; background: #f1f1f1; padding: 5px 8px; border-radius: 4px; }
    .tabs { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin-bottom: 20px; }
    .tabs button { padding: 12px 5px; cursor: pointer; background: #f9f9f9; border: 1px solid #ddd; font-weight: 600; transition: all 0.3s; border-radius: 5px; font-size:0.9rem; }
    .tabs button.active { background: var(--color-accent); color: white; border-color: var(--color-accent); }
    .preview { flex: 1; padding: 20px; background-color: #dce3e9; display: flex; justify-content: center; align-items: center; }
    .preview-frame { width: 100%; height: 100%; display: flex; flex-direction: column; }
    .preview-container { width: 100%; flex: 1; border: 8px solid #333; border-radius: 10px; background: var(--color-bg); color: var(--color-text); box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden; display: flex; flex-direction: column; }
    .btn { display: inline-block; padding: 12px 25px; background: var(--color-accent); color: #fff; border: none; border-radius: 5px; cursor: pointer; font-weight: 600; text-align: center; text-decoration: none; transition: all 0.3s; font-size: 1rem; }
    .btn:hover { filter: brightness(1.1); transform: translateY(-2px); box-shadow: var(--shadow-sm); }
    .btn-group { margin-top: auto; padding-top: 20px; border-top: 1px solid #eee; }
    hr.form-divider { border: none; border-top: 1px solid #eee; margin: 25px 0; }

    /* --- Styles pour la prévisualisation --- */
    #websitePreview { height: 100%; overflow-y: auto; font-family: var(--font-main); background: var(--color-bg); color: var(--color-text); scroll-behavior: smooth; }
    #websitePreview header { position: sticky; top: 0; z-index: 1000; background: var(--color-surface); box-shadow: var(--shadow-sm); }
    #websitePreview nav { display:flex; justify-content:space-between; align-items:center; padding: 15px 5%; }
    #websitePreview .logo-container .logo { font-size:1.6rem; font-weight:700; color: var(--color-accent); }
    #websitePreview .logo-container .subtext { font-size: 0.9rem; color: var(--color-text); opacity: 0.8; }
    #websitePreview nav ul { list-style:none; display:flex; gap:30px; }
    #websitePreview nav a { color: var(--color-text); text-decoration:none; font-weight:600; padding-bottom: 5px; border-bottom: 2px solid transparent; transition: all 0.3s; }
    #websitePreview nav a.active, #websitePreview nav a:hover { color: var(--color-accent); border-bottom-color: var(--color-accent); }
    #websitePreview .page-content { display: none; }
    #websitePreview .page-content.active { display: block; animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    #websitePreview .hero { display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; min-height: 60vh; color: #fff; background-size: cover; background-position: center; padding: 20px; position: relative; }
    #websitePreview .hero::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 0; }
    #websitePreview .hero-content { position: relative; z-index: 1; }
    #websitePreview h1 { font-size: clamp(2rem, 5vw, 3rem); color: #fff; } #websitePreview h2 { font-size: clamp(1.8rem, 4vw, 2.5rem); margin-bottom: 40px; text-align: center; color: var(--color-heading); } #websitePreview h3 { font-size: 1.5rem; color: var(--color-heading); }
    #websitePreview .section { padding: 60px 5%; }
    #websitePreview .section-alt { background-color: var(--color-surface); }
    #websitePreview .about p { max-width: 800px; margin: 20px auto 0; text-align: center; font-size: 1.1rem; }
    #websitePreview .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
    #websitePreview .card { background: var(--color-bg); padding: 25px; border-radius: 8px; box-shadow: var(--shadow-sm); }
    #websitePreview .testimonial-card p { font-style: italic; }
    #websitePreview .testimonial-card .author { font-weight: bold; margin-top: 15px; color: var(--color-accent); }
    #websitePreview .catalog-item { padding: 0; display: flex; flex-direction: column; transition: transform 0.3s, box-shadow 0.3s; }
    #websitePreview .catalog-item:hover { transform: translateY(-5px); box-shadow: var(--shadow-md); }
    #websitePreview .catalog-item img { width: 100%; height: 200px; object-fit: cover; border-top-left-radius: 8px; border-top-right-radius: 8px; }
    #websitePreview .catalog-item .item-content { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; }
    #websitePreview .catalog-item h3 { margin-top: 0; margin-bottom: 10px; } #websitePreview .catalog-item p { flex-grow: 1; margin-bottom: 15px; } #websitePreview .catalog-item .price { font-weight: bold; color: var(--color-accent); text-align: right; }
    #websitePreview .gallery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
    #websitePreview .gallery-item img { width: 100%; height: 250px; object-fit: cover; border-radius: 8px; transition: transform 0.3s; }
    #websitePreview .gallery-item img:hover { transform: scale(1.05); }
    #websitePreview .gallery-item figcaption { text-align: center; margin-top: 10px; font-style: italic; opacity: 0.8; }
    #websitePreview .contact-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px; }
    #websitePreview .contact-info p { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; } #websitePreview .contact-info p i { color: var(--color-accent); font-size: 1.2rem; width: 20px; text-align: center; }
    #websitePreview .map-container iframe { width: 100%; height: 100%; min-height: 250px; border: 0; border-radius: 8px; }
    #websitePreview footer { background: #212529; color: #fff; padding:40px 20px; text-align:center; }
    #websitePreview .social-links a { color: #fff; font-size: 1.5rem; margin: 0 10px; transition: color 0.3s; }
    #websitePreview .social-links a:hover { color: var(--color-accent); }

    /* --- Responsive Design --- */
    @media (max-width: 900px) {
        .container { flex-direction: column; height: auto; }
        .customizer { width: 100%; height: auto; max-height: 50vh; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .preview { padding: 10px; height: 100vh; }
        .preview-container { border-width: 4px; }
        #websitePreview nav { flex-direction: column; gap: 15px; }
    }
</style>
</head>
<body>
<div class="container">
    <div class="customizer">
        <h2><i class="fas fa-palette"></i> Panneau PRO</h2>
        <div class="tabs">
            <button class="tab-btn active" data-page="general">Général</button>
            <button class="tab-btn" data-page="accueil">Accueil</button>
            <button class="tab-btn" data-page="catalogue">Catalogue</button>
            <button class="tab-btn" data-page="galerie">Galerie</button>
            <button class="tab-btn" data-page="temoignages">Témoignages</button>
            <button class="tab-btn" data-page="contact">Contact</button>
        </div>
        <div id="tabContent"></div>
        <div class="btn-group">
            <button class="btn" id="exportJsonBtn"><i class="fas fa-file-code"></i> Exporter la Configuration</button>
        </div>
    </div>
    <div class="preview">
        <div class="preview-frame">
             <div class="preview-container">
                  <div id="websitePreview"></div>
             </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- 1. STATE (Toutes les données du site) ---
    let websiteData = {
        general: {
            siteTitle: "Artisan Créateur", headerSubtext: "L'excellence, sur mesure.", theme: "light",
            colorAccent: '#c0392b', colorHeading: '#2c3e50', colorText: '#34495e', colorBg: '#ffffff', colorSurface: '#ecf0f1',
        },
        accueil: {
            heroTitle: 'L\'Art de la Création', heroSubtitle: 'Donnez vie à vos projets avec un savoir-faire unique.', heroImage: 'https://images.unsplash.com/photo-1555949963-ff9fe0c870eb?q=80&w=2070&auto=format&fit=crop',
            ctaText: 'Découvrir nos services', ctaLink: '#catalogue',
            aboutTitle: 'Notre Histoire', aboutText: 'Passionnés par notre métier, nous combinons techniques traditionnelles et innovations pour des résultats qui dépassent vos attentes. Chaque projet est une nouvelle aventure.',
        },
        catalogue: {
            pageTitle: 'Nos Services',
            items: [{ name: 'Conception sur Mesure', desc: 'Analyse de vos besoins et création d\'un plan détaillé.', price: 'Sur devis', image: 'https://images.unsplash.com/photo-1519389950473-47ba0277781c?q=80&w=2070&auto=format&fit=crop' }, { name: 'Fabrication Artisanale', desc: 'Réalisation dans notre atelier avec des matériaux de première qualité.', price: 'À partir de 450€', image: 'https://plus.unsplash.com/premium_photo-1672287578699-618ea6dbcc9e?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D' }],
        },
        galerie: {
            pageTitle: 'Nos Réalisations en Images',
            images: [
                { url: 'https://images.unsplash.com/photo-1638718260002-18bdc8082608?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', caption: 'Projet résidentiel A' },
                { url: 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', caption: 'Détail de fabrication' },
                { url: 'https://images.unsplash.com/photo-1510915228340-29c85a43dcfe?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D', caption: 'Projet commercial B' },
            ]
        },
        temoignages: {
            title: 'Ce que disent nos clients',
            items: [
                { text: 'Un professionnalisme et une écoute rares. Le résultat est au-delà de mes espérances. Je recommande les yeux fermés !', author: 'Julien M.' },
                { text: 'Équipe très réactive et travail d\'une qualité irréprochable. Les délais ont été respectés. Parfait.', author: 'Sophie L.' },
            ]
        },
        contact: {
            pageTitle: 'Nous Contacter', introText: 'Un projet en tête ? Parlons-en !', address: '5 Avenue de l\'Artisanat, 75012 Paris', phone: '01 23 45 67 89', email: 'contact@artisan.fr',
            mapUrl: 'http://googleusercontent.com/maps.google.com/6',
            footerText: `© ${new Date().getFullYear()} Artisan Créateur. Tous droits réservés. Site Web réalisé par Lecointre David`,
            social: { facebook: 'https://facebook.com', instagram: 'https://instagram.com', linkedin: 'https://linkedin.com' }
        }
    };

    // --- 2. DOM Elements (Références aux éléments de la page) ---
    const DOM = {
        tabs: document.querySelectorAll('.tab-btn'), tabContent: document.getElementById('tabContent'), preview: document.getElementById('websitePreview'),
        exportJsonBtn: document.getElementById('exportJsonBtn')
    };
    let currentCustomizerPage = 'general', currentPreviewPage = 'accueil';

    // --- 3. CORE FUNCTIONS (Logique principale) ---

    const updateState = (path, value) => {
        path.split('.').reduce((acc, key, i, arr) => {
            if (i === arr.length - 1) {
                acc[key] = value;
            }
            return acc[key];
        }, websiteData);
        if (path.startsWith('general.color') || path === 'general.theme') applyTheme();
        renderPreview(currentPreviewPage);
    };

    const switchTab = (page) => {
        currentCustomizerPage = page;
        DOM.tabs.forEach(btn => btn.classList.toggle('active', btn.dataset.page === page));
        renderCustomizerForm(page);
    };
    
    const createFormGroup = (path, label, type = 'text', options = {}) => {
        const value = path.split('.').reduce((acc, key) => acc && acc[key], websiteData);
        const group = document.createElement('div');
        group.className = `form-group ${type === 'color' ? 'color-input' : ''}`;
        
        let inputEl, labelEl = `<label for="${path}">${label}</label>`;
        if (type === 'color') {
            inputEl = `<input type="color" id="${path}" value="${value}"><span class="color-value">${value}</span>`;
            group.innerHTML = `<div>${labelEl}</div><div>${inputEl}</div>`;
        } else {
            group.innerHTML = labelEl;
            if (type === 'textarea') inputEl = document.createElement('textarea');
            else if (type === 'select') {
                inputEl = document.createElement('select');
                inputEl.innerHTML = options.choices.map(opt => `<option value="${opt.value}" ${value === opt.value ? 'selected' : ''}>${opt.text}</option>`).join('');
            } else {
                inputEl = document.createElement('input'); inputEl.type = type; inputEl.placeholder = options.placeholder || '';
            }
            if (type !== 'select') inputEl.value = value;
            inputEl.id = path;
            group.appendChild(inputEl);
        }
        
        group.addEventListener('input', e => {
            if (e.target.id === path) {
                updateState(path, e.target.value);
                if (type === 'color') e.target.nextElementSibling.textContent = e.target.value;
            }
        });
        return group;
    };

    const renderCustomizerForm = (page) => {
        DOM.tabContent.innerHTML = '';
        const fragment = document.createDocumentFragment();
        const addField = (path, label, type, options) => fragment.appendChild(createFormGroup(path, label, type, options));
        const addDivider = () => { const hr = document.createElement('hr'); hr.className = 'form-divider'; fragment.appendChild(hr); };
        const addSubheading = (text) => { const h = document.createElement('h4'); h.textContent = text; fragment.appendChild(h); };

        switch (page) {
             case 'general':
                addField('general.siteTitle', 'Titre du site'); addField('general.headerSubtext', 'Slogan / Texte en-tête');
                addField('general.theme', 'Thème de base', 'select', { choices: [{value: 'light', text: 'Clair'}, {value: 'dark', text: 'Sombre'}]});
                addDivider();
                addSubheading('Palette de Couleurs');
                addField('general.colorAccent', 'Accent (boutons, liens)', 'color'); addField('general.colorHeading', 'Titres', 'color'); addField('general.colorText', 'Texte courant', 'color');
                addField('general.colorBg', 'Fond des pages', 'color'); addField('general.colorSurface', 'Surface (cartes, en-tête)', 'color');
                break;
            case 'accueil':
                addField('accueil.heroTitle', 'Titre principal'); addField('accueil.heroSubtitle', 'Sous-titre', 'textarea'); addField('accueil.heroImage', 'URL de l\'image de fond', 'text', {placeholder:'https://...'});
                addField('accueil.ctaText', 'Texte du bouton d\'action'); addField('accueil.ctaLink', 'Lien du bouton (ex: #contact)');
                addDivider();
                addField('accueil.aboutTitle', 'Titre section "A Propos"'); addField('accueil.aboutText', 'Texte "A Propos"', 'textarea');
                break;
            case 'catalogue':
                addField('catalogue.pageTitle', 'Titre de la page');
                websiteData.catalogue.items.forEach((_, i) => { addDivider(); addSubheading(`Article ${i + 1}`);
                    addField(`catalogue.items.${i}.name`, 'Nom'); addField(`catalogue.items.${i}.desc`, 'Description', 'textarea');
                    addField(`catalogue.items.${i}.price`, 'Prix'); addField(`catalogue.items.${i}.image`, 'URL Image', 'text', {placeholder:'https://...'});
                });
                break;
            case 'galerie':
                addField('galerie.pageTitle', 'Titre de la page');
                websiteData.galerie.images.forEach((_, i) => { addDivider(); addSubheading(`Image ${i + 1}`);
                    addField(`galerie.images.${i}.url`, 'URL Image', 'text', {placeholder:'https://...'}); addField(`galerie.images.${i}.caption`, 'Légende');
                });
                break;
            case 'temoignages':
                addField('temoignages.title', 'Titre de la section');
                websiteData.temoignages.items.forEach((_, i) => { addDivider(); addSubheading(`Témoignage ${i + 1}`);
                    addField(`temoignages.items.${i}.text`, 'Texte', 'textarea'); addField(`temoignages.items.${i}.author`, 'Auteur');
                });
                break;
            case 'contact':
                addField('contact.pageTitle', 'Titre de la page'); addField('contact.introText', 'Texte d\'introduction', 'textarea');
                addDivider();
                addField('contact.address', 'Adresse'); addField('contact.phone', 'Téléphone'); addField('contact.email', 'E-mail');
                addField('contact.mapUrl', 'URL d\'intégration Google Maps', 'textarea');
                addDivider();
                addSubheading('Réseaux Sociaux');
                addField('contact.social.facebook', 'Lien Facebook', 'text', {placeholder:'https://...'}); addField('contact.social.instagram', 'Lien Instagram', 'text', {placeholder:'https://...'}); addField('contact.social.linkedin', 'Lien LinkedIn', 'text', {placeholder:'https://...'});
                addDivider();
                addField('contact.footerText', 'Texte du pied de page');
                break;
        }
        DOM.tabContent.appendChild(fragment);
    };

    const renderPreview = (activePage = 'accueil') => {
        currentPreviewPage = activePage;
        const data = websiteData;
        const navLinks = [
            { id: 'accueil', text: 'Accueil' }, { id: 'catalogue', text: data.catalogue.pageTitle.split(' ')[0] || 'Catalogue' },
            { id: 'galerie', text: 'Galerie' }, { id: 'contact', text: 'Contact' }
        ];

        DOM.preview.innerHTML = `
            <header><nav>
                <div class="logo-container"><div class="logo">${data.general.siteTitle}</div><div class="subtext">${data.general.headerSubtext}</div></div>
                <ul>${navLinks.map(l => `<li><a href="#${l.id}" data-page="${l.id}" class="${activePage === l.id ? 'active' : ''}">${l.text}</a></li>`).join('')}</ul>
            </nav></header>
            <main>
                <div class="page-content ${activePage === 'accueil' ? 'active' : ''}" id="page-accueil">
                    <section class="hero" style="background-image: url('${data.accueil.heroImage}');"><div class="hero-content"><h1>${data.accueil.heroTitle}</h1><p>${data.accueil.heroSubtitle}</p><a href="${data.accueil.ctaLink}" class="btn cta-btn">${data.accueil.ctaText}</a></div></section>
                    <section class="section about"><h2>${data.accueil.aboutTitle}</h2><p>${data.accueil.aboutText.replace(/\n/g, '<br>')}</p></section>
                    <section class="section section-alt testimonials"><h2>${data.temoignages.title}</h2><div class="card-grid">${data.temoignages.items.map(t => `<div class="card testimonial-card"><p>"${t.text}"</p><div class="author">- ${t.author}</div></div>`).join('')}</div></section>
                </div>
                <div class="page-content ${activePage === 'catalogue' ? 'active' : ''}" id="page-catalogue">
                    <section class="section"><h2>${data.catalogue.pageTitle}</h2><div class="card-grid">${data.catalogue.items.map(i => `<div class="card catalog-item"><img src="${i.image}" alt="${i.name}"><div class="item-content"><h3>${i.name}</h3><p>${i.desc}</p>${i.price ? `<div class="price">${i.price}</div>` : ''}</div></div>`).join('')}</div></section>
                </div>
                <div class="page-content ${activePage === 'galerie' ? 'active' : ''}" id="page-galerie">
                    <section class="section"><h2>${data.galerie.pageTitle}</h2><div class="gallery-grid">${data.galerie.images.map(i => `<figure class="gallery-item"><img src="${i.url}" alt="${i.caption}"><figcaption>${i.caption}</figcaption></figure>`).join('')}</div></section>
                </div>
                <div class="page-content ${activePage === 'contact' ? 'active' : ''}" id="page-contact">
                    <section class="section"><h2>${data.contact.pageTitle}</h2><p style="text-align:center; max-width:700px; margin: 0 auto 40px;">${data.contact.introText}</p>
                    <div class="contact-grid">
                        <div class="card contact-info"><h3>Nos coordonnées</h3><p><i class="fas fa-map-marker-alt"></i> ${data.contact.address}</p><p><i class="fas fa-phone"></i> ${data.contact.phone}</p><p><i class="fas fa-envelope"></i> <a href="mailto:${data.contact.email}">${data.contact.email}</a></p></div>
                        ${data.contact.mapUrl ? `<div class="map-container"><h3>Nous trouver</h3><iframe src="${data.contact.mapUrl}" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div>` : ''}
                    </div></section>
                </div>
            </main>
            <footer><div class="social-links">${Object.entries(data.contact.social).filter(([_, v]) => v).map(([k, v]) => `<a href="${v}" target="_blank" aria-label="${k}"><i class="fab fa-${k}"></i></a>`).join('')}</div><p>${data.contact.footerText}</p></footer>`;
        
        DOM.preview.querySelectorAll('nav a, .cta-btn').forEach(link => {
            link.addEventListener('click', e => { e.preventDefault();
                const targetPage = (link.dataset.page || link.getAttribute('href')).replace('#', '');
                if (navLinks.map(l => l.id).includes(targetPage)) renderPreview(targetPage);
            });
        });
    };
    
    const applyTheme = () => {
        const data = websiteData.general;
        const root = document.documentElement;
        root.className = data.theme === 'dark' ? 'dark-theme' : '';
        Object.entries(data).forEach(([key, value]) => {
            if (key.startsWith('color')) {
                const cssVar = `--${key.replace(/([A-Z])/g, '-$1').toLowerCase()}`;
                root.style.setProperty(cssVar, value);
            }
        });
    };

    const exportJson = () => {
        const jsonString = JSON.stringify(websiteData, null, 2);
        const blob = new Blob([jsonString], { type: 'application/json' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'config-site.json';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(a.href);
    };

    // --- 4. INITIALIZATION (Lancement de l'application) ---
    DOM.tabs.forEach(btn => btn.addEventListener('click', () => switchTab(btn.dataset.page)));
    DOM.exportJsonBtn.addEventListener('click', exportJson);
    
    applyTheme();
    switchTab(currentCustomizerPage);
    renderPreview(currentPreviewPage);
});
</script>
</body>
</html>